<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>AI ëª¨ë¸ ë¹„êµ Â· ElectionAI</title>
<link rel="stylesheet" href="css/style.css">
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<style>
.ai-model-card {
  background: white; border-radius: var(--radius); padding: 20px 24px;
  border: 1px solid var(--border); box-shadow: var(--shadow);
  border-top: 4px solid;
}
.ai-model-header { display: flex; align-items: center; gap: 10px; margin-bottom: 14px; }
.ai-model-icon { font-size: 24px; }
.ai-model-name { font-size: 18px; font-weight: 800; }
.ai-model-desc { font-size: 12px; color: var(--text-muted); }
.ai-score-row { display: flex; align-items: center; gap: 10px; margin-bottom: 8px; }
.ai-score-name { font-size: 13px; font-weight: 600; flex: 1; }
.ai-score-bar-wrap { flex: 2; }
.ai-score-val { font-size: 14px; font-weight: 800; width: 40px; text-align: right; }
.consistency-badge {
  padding: 3px 10px; border-radius: 20px; font-size: 12px; font-weight: 700;
}
</style>
</head>
<body>

<header class="app-header">
  <div class="header-inner">
    <div class="header-logo">âš–ï¸ Election<span>AI</span></div>
    <div class="header-subtitle">AI ê¸°ë°˜ ì„ ê±° í›„ë³´ì ë¹„êµ ë¶„ì„ í”Œë«í¼</div>
    <div class="header-date" id="header-date"></div>
  </div>
</header>
<nav class="main-nav"><div class="nav-inner" id="main-nav"></div></nav>

<div class="page-container">
  <div class="page-title">
    <h1>ğŸ¤– AI ëª¨ë¸ë³„ ì ìˆ˜ ë¹„êµ</h1>
    <p>Claude Â· ChatGPT Â· Gemini Â· Grok 4ê°œ AI ëª¨ë¸ì˜ í‰ê°€ ê²°ê³¼ ë° ì¼ê´€ì„± ë¶„ì„</p>
  </div>
  <div id="page-content"></div>
</div>

<button class="print-btn" onclick="window.open('report_full.html','_blank')" title="ì „ì²´ PDF ë³´ê³ ì„œ">ğŸ“¥</button>

<script src="js/shared.js"></script>
<script>
const AI_ICONS = { claude: 'ğŸŸ£', chatgpt: 'ğŸŸ¢', gemini: 'ğŸ”µ', grok: 'ğŸ”´' };
const AI_BORDER = { claude: '#7c3aed', chatgpt: '#16a34a', gemini: '#2563eb', grok: '#dc2626' };
const AI_DESCS = {
  claude: 'ì œë„í™”Â·ì§€ì†ê°€ëŠ¥ì„± ì¤‘ì‹¬ í‰ê°€',
  chatgpt: 'í˜ì‹ ì„±Â·ì‚¬íšŒì  ì˜í–¥ë ¥ ê· í˜•',
  gemini: 'ê³µê°œ ë°ì´í„° í­ë„“ìŒÂ·ì„±ê³¼ ì¤‘ì‹¬',
  grok: 'ìµœì‹  ì´ìŠˆÂ·í˜„ì¥ ëŒ€ì‘ ì¤‘ì‹¬'
};

document.addEventListener('DOMContentLoaded', () => {
  const data = requireData();
  if (!data) return;

  const { candidates } = data;
  const n = candidates.length;
  let html = '';

  // â”€â”€ ê·¸ë£¹ ë§‰ëŒ€ ì°¨íŠ¸ â”€â”€
  html += `<div class="card"><div class="card-title">ğŸ“Š AI ëª¨ë¸ Ã— í›„ë³´ì ì ìˆ˜ ë¹„êµ</div>
    <div class="chart-container" style="height:380px">
      <canvas id="aiGroupBar"></canvas>
    </div></div>`;

  // â”€â”€ AI ëª¨ë¸ë³„ ìˆœìœ„ â”€â”€
  html += `<div class="card"><div class="card-title">ğŸ† AI ëª¨ë¸ë³„ í›„ë³´ì ìˆœìœ„</div>
    <div class="table-wrap"><table>
      <thead><tr><th>í›„ë³´ì</th>`;
  AI_MODELS.forEach(m => {
    html += `<th style="color:${AI_BORDER[m]}">${AI_ICONS[m]} ${AI_LABELS[m]}</th>`;
  });
  html += `<th>í‰ê· </th><th>í¸ì°¨</th><th>ì¼ê´€ì„±</th></tr></thead><tbody>`;

  candidates.forEach((c, i) => {
    const col = CANDIDATE_COLORS[i % 5];
    const scores = AI_MODELS.map(m => c.ai_scores?.[m] ?? 0);
    const avg = scores.reduce((a,b)=>a+b,0)/scores.length;
    const std = Math.sqrt(scores.reduce((s,v)=>s+Math.pow(v-avg,2),0)/scores.length);
    const consistency = std < 5 ? { label: 'ë§¤ìš° ë†’ìŒ', cls: 'score-excellent' }
                      : std < 10 ? { label: 'ë†’ìŒ', cls: 'score-good' }
                      : std < 15 ? { label: 'ë³´í†µ', cls: 'score-average' }
                      : { label: 'ë‚®ìŒ', cls: 'score-low' };
    html += `<tr>
      <td style="color:${col.border};font-weight:700">${c.name}</td>`;
    AI_MODELS.forEach(m => {
      html += `<td style="font-weight:700">${c.ai_scores?.[m] ?? '-'}</td>`;
    });
    html += `<td style="font-weight:800">${avg.toFixed(1)}</td>
      <td>${std.toFixed(1)}</td>
      <td><span class="consistency-badge ${consistency.cls}">${consistency.label}</span></td>
    </tr>`;
  });

  // AIë³„ ìµœê³  í‰ê°€ í›„ë³´
  html += `<tr style="background:#f8fafc;font-size:12px"><td style="color:var(--text-muted);font-weight:600">AI 1ìœ„ í›„ë³´</td>`;
  AI_MODELS.forEach(m => {
    const best = candidates.reduce((b,c) => (c.ai_scores?.[m]??0) > (b.ai_scores?.[m]??0) ? c : b);
    html += `<td style="font-size:11px;color:${AI_BORDER[m]};font-weight:700">${best.name}<br>${best.ai_scores?.[m]}</td>`;
  });
  html += `<td colspan="3"></td></tr>`;

  html += `</tbody></table></div></div>`;

  // â”€â”€ AI ëª¨ë¸ë³„ ì¹´ë“œ â”€â”€
  html += `<div class="grid-2">`;
  AI_MODELS.forEach(m => {
    const scores = candidates.map((c,i) => ({ name:c.name, score:c.ai_scores?.[m]??0, col:CANDIDATE_COLORS[i%5] }))
      .sort((a,b)=>b.score-a.score);
    const avg = scores.reduce((s,x)=>s+x.score,0)/scores.length;

    html += `<div class="ai-model-card" style="border-top-color:${AI_BORDER[m]}">
      <div class="ai-model-header">
        <span class="ai-model-icon">${AI_ICONS[m]}</span>
        <div>
          <div class="ai-model-name" style="color:${AI_BORDER[m]}">${AI_LABELS[m]}</div>
          <div class="ai-model-desc">${AI_DESCS[m]}</div>
        </div>
        <span style="margin-left:auto;font-size:12px;color:var(--text-muted)">í‰ê·  ${avg.toFixed(1)}ì </span>
      </div>`;

    scores.forEach((s, rank) => {
      html += `<div class="ai-score-row">
        <div style="display:flex;align-items:center;gap:6px;flex:1">
          ${rankTag(rank+1)}
          <span class="ai-score-name" style="color:${s.col.border}">${s.name}</span>
        </div>
        <div class="ai-score-bar-wrap">
          <div class="progress-bar">
            <div class="progress-fill" style="width:${(s.score/1000)*100}%;background:${AI_BORDER[m]}"></div>
          </div>
        </div>
        <div class="ai-score-val" style="color:${AI_BORDER[m]}">${s.score}</div>
      </div>`;
    });
    html += `</div>`;
  });
  html += `</div>`;

  // â”€â”€ AI ëª¨ë¸ ê°„ ì¼ê´€ì„± ë¶„ì„ â”€â”€
  html += `<div class="card"><div class="card-title">ğŸ“ í›„ë³´ë³„ AI í‰ê°€ ì¼ê´€ì„± ë¶„ì„</div>`;
  candidates.forEach((c, i) => {
    const col = CANDIDATE_COLORS[i % 5];
    const scores = AI_MODELS.map(m => c.ai_scores?.[m] ?? 0).filter(s => s > 0);
    if (scores.length === 0) return;
    const avg = scores.reduce((a,b)=>a+b,0)/scores.length;
    const std = Math.sqrt(scores.reduce((s,v)=>s+Math.pow(v-avg,2),0)/scores.length);
    const spread = Math.max(...scores) - Math.min(...scores);
    html += `<div class="strength-card">
      <div style="display:flex;align-items:center;gap:10px;margin-bottom:10px">
        <strong style="color:${col.border};font-size:15px">${c.name}</strong>
        <span style="font-size:12px;color:var(--text-muted)">${c.party}</span>
        <span style="margin-left:auto;font-size:12px">í¸ì°¨: <strong>${std.toFixed(1)}</strong> Â· ë²”ìœ„: <strong>${spread}ì </strong></span>
      </div>
      <div style="display:flex;gap:8px;flex-wrap:wrap">
        ${AI_MODELS.map(m => {
          const s = c.ai_scores?.[m] ?? 0;
          const diff = s - avg;
          return `<div style="text-align:center;min-width:70px;background:#f8fafc;border-radius:8px;padding:8px 10px">
            <div style="font-size:11px;color:${AI_BORDER[m]};font-weight:700">${AI_LABELS[m]}</div>
            <div style="font-size:18px;font-weight:900;color:${col.border}">${s}</div>
            <div style="font-size:11px;color:${diff>0?'#16a34a':diff<0?'#dc2626':'#94a3b8'}">${diff>0?'+'+diff.toFixed(1):diff.toFixed(1)}</div>
          </div>`;
        }).join('')}
      </div>
    </div>`;
  });
  html += `<div class="insight-box">í¸ì°¨ê°€ ë‚®ì„ìˆ˜ë¡ AI ëª¨ë¸ ê°„ í‰ê°€ê°€ ì¼ì¹˜í•˜ë©° ì‹ ë¢°ë„ê°€ ë†’ìŠµë‹ˆë‹¤. ë†’ì€ í¸ì°¨ëŠ” íŠ¹ì • AIì—ì„œ ë‹¤ë¥´ê²Œ íŒë‹¨ë˜ì—ˆìŒì„ ì˜ë¯¸í•©ë‹ˆë‹¤.</div>
  </div>`;

  // â”€â”€ ë¼ì¸ ì°¨íŠ¸ (ëª¨ë¸ë³„ ì¶”ì„¸) â”€â”€
  html += `<div class="card"><div class="card-title">ğŸ“ˆ AI ëª¨ë¸ë³„ í‰ê°€ ì¶”ì„¸ ë¹„êµ</div>
    <div class="chart-container" style="height:300px">
      <canvas id="lineChart"></canvas>
    </div></div>`;

  document.getElementById('page-content').innerHTML = html;

  // â”€â”€ ê·¸ë£¹ ë§‰ëŒ€ ì°¨íŠ¸ â”€â”€
  new Chart(document.getElementById('aiGroupBar'), {
    type: 'bar',
    data: {
      labels: candidates.map(c => c.name),
      datasets: AI_MODELS.map(m => ({
        label: AI_LABELS[m],
        data: candidates.map(c => c.ai_scores?.[m] ?? 0),
        backgroundColor: AI_BORDER[m] + '30',
        borderColor: AI_BORDER[m],
        borderWidth: 2,
        borderRadius: 4,
      }))
    },
    options: {
      responsive: true, maintainAspectRatio: false,
      scales: {
        x: { ticks: { font: { size: 12 } }, grid: { display: false } },
        y: { min: 650, max: 900, ticks: { font: { size: 11 } }, grid: { color: '#f1f5f9' } }
      },
      plugins: { legend: { position: 'bottom', labels: { font: { size: 12 }, padding: 14 } } }
    }
  });

  // â”€â”€ ë¼ì¸ ì°¨íŠ¸ â”€â”€
  new Chart(document.getElementById('lineChart'), {
    type: 'line',
    data: {
      labels: AI_MODELS.map(m => AI_LABELS[m]),
      datasets: candidates.map((c, i) => ({
        label: c.name,
        data: AI_MODELS.map(m => c.ai_scores?.[m] ?? 0),
        borderColor: CANDIDATE_COLORS[i%5].border,
        backgroundColor: CANDIDATE_COLORS[i%5].bg,
        borderWidth: 2,
        pointRadius: 6,
        pointBackgroundColor: CANDIDATE_COLORS[i%5].border,
        tension: 0.3,
      }))
    },
    options: {
      responsive: true, maintainAspectRatio: false,
      scales: {
        x: { ticks: { font: { size: 13, weight: '600' } } },
        y: { min: 650, max: 900, grid: { color: '#f1f5f9' } }
      },
      plugins: { legend: { position: 'bottom', labels: { font: { size: 12 }, padding: 16 } } }
    }
  });
});
</script>
</body>
</html>
